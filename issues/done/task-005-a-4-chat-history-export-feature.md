# 015: Task - 会話履歴ファイル出力（エクスポート）機能の実装

## 概要

ユーザーがWebUIおよびCLIのREPLから、現在のチャットセッションの会話履歴をテキストファイルまたはJSON形式でローカルにエクスポートできるようにする機能を実装します。

## 関連仕様書

- [会話履歴ファイル出力（エクスポート）機能 仕様書](../doc/chat_history_export_feature_spec.md)

## 受け入れ基準 (Acceptance Criteria)

- **UI (Gradio)**
  - [ ] WebUIに「履歴をエクスポート」ボタンが配置されている。
  - [ ] ボタンの近くに、出力形式（テキスト/JSON）を選択するドロップダウンがある。
  - [ ] ボタンクリック時、選択された形式で会話履歴がファイルとしてダウンロードされる。
  - [ ] ファイル名は自動生成される。
- **CLI (REPL)**
  - [ ] REPLで `/export [filename] [--format <format>]` コマンドが利用できる。
  - [ ] コマンド実行時、指定されたファイル名と形式で会話履歴が保存される。
  - [ ] ファイル名が省略された場合は自動生成される。
  - [ ] エクスポート成功時にREPLにメッセージが表示される。
- **共通**
  - [ ] 会話履歴データをテキスト形式およびJSON形式に変換するロジックが実装されている。
  - [ ] 新機能に関するユニットテストが追加され、すべてのテストがパスする。

## タスク分割 (Sub-tasks)

1.  **Chat Logic**: `chat_logic.py` に、現在の会話履歴データを取得し、指定された形式（テキスト/JSON）に変換するメソッドを追加する。
2.  **Web UI**: `webui.py` に「履歴をエクスポート」ボタンと出力形式選択ドロップダウンを追加する。ボタンクリック時に `chat_logic` のエクスポートメソッドを呼び出し、Gradioのダウンロード機能 (`gr.File`) を利用してファイルを提供できるようにする。
3.  **CLI**: `cli.py` のREPLに `/export` コマンドのパーサーと、`chat_logic` のエクスポートメソッドを呼び出し、ファイルに書き込むロジックを実装する。
4.  **Testing**: `tests/` ディレクトリ内の関連テストファイル（`test_chat_logic.py`, `test_webui.py`, `test_cli.py` 等）に、履歴エクスポート機能の動作を検証するユニットテストを追加する。
5.  **Documentation**: `README.md` や関連ドキュメントを更新し、新しい履歴エクスポート機能の使い方を説明する。
