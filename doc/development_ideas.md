# 開発アイデアメモ

このドキュメントは、将来的に実装したい機能や改善案を、形式ばらずに自由に記述していくためのものです。

---

## 高度なコンテキスト管理

会話が長くなった際のAPIコスト、速度低下、コンテキスト上限の問題に対応するため、より高度なコンテキスト管理を導入する。

### フェーズ1：要約 ＋ スライディングウィンドウ

- **目的**: 実用的なレベルでトークン数を削減し、コストとパフォーマンスを両立させる。
- **アイデア**:
    - 会話の序盤（最初の数ターン）から、会話全体のテーマや重要な設定（AIのペルソナなど）を要約し、常にコンテキストに含める。
    - 直近のN回分の会話履歴を「スライディングウィンドウ」としてコンテキストに含める。
    - APIに送信するコンテキスト = 「テーマの要約」 + 「直近N回の会話」

### フェーズ2：RAG (Retrieval-Augmented Generation) の導入

- **目的**: 長期的な記憶を実現し、過去の会話全体を踏まえた、より深い応答を可能にする。
- **アイデア**:
    - 会話のターンごとに、発言内容を埋め込み（Embedding）ベクトル化する。
    - ベクトル化したデータをベクトルDB（例: ChromaDB, FAISS）に保存する。
    - 新しいユーザー入力があった際に、その入力と関連性の高い過去の会話をベクトルDBから検索（セマンティックサーチ）する。
    - APIに送信するコンテキスト = 「現在のプロンプト」 + 「検索で取得した関連性の高い過去の会話」
    - （さらに高度化）会話からナレッジグラフ（トリプルストア）を構築し、関係性を明確にすることで、より正確な情報検索を目指す。

